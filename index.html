<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Manual Google Form Submitter</title>
<style>
  body { font-family: Arial, sans-serif; padding:20px; background:#f4f4f9; }
  input, button { padding:8px; margin:8px 0; width:100%; }
  .question { margin-bottom:10px; }
</style>
</head>
<body>
<h1>Google Form Submitter (Manual Fields)</h1>
<p>Input your Google Form POST URL and define fields manually.</p>

<label>Form POST URL:</label>
<input type="url" id="form-url" placeholder="https://docs.google.com/forms/d/e/..." />

<div id="fields-container">
  <h2>Fields</h2>
  <div class="question">
    <label for="field1">Question 1 (name attribute):</label>
    <input type="text" id="field1" placeholder="Enter field name, e.g., entry.123456" />
    <label>Answer value:</label>
    <input type="text" id="answer1" placeholder="Your answer" />
  </div>
  <div class="question">
    <label for="field2">Question 2 (name attribute):</label>
    <input type="text" id="field2" placeholder="Enter field name" />
    <label>Answer value:</label>
    <input type="text" id="answer2" placeholder="Your answer" />
  </div>
  <!-- Add more questions as needed -->
</div>

<button id="submit-btn">Submit Responses</button>

<div id="response-log" style="margin-top:20px; padding:10px; background:#fff; height:150px; overflow-y:auto;"></div>

<script>
  const submitBtn = document.getElementById('submit-btn');
  const formUrlInput = document.getElementById('form-url');
  const logDiv = document.getElementById('response-log');

  function log(msg) {
    const timestamp = new Date().toLocaleTimeString();
    logDiv.innerHTML += `[${timestamp}] ${msg}<br/>`;
    logDiv.scrollTop = logDiv.scrollHeight;
  }

  document.getElementById('submit-btn').addEventListener('click', async () => {
    const url = formUrlInput.value.trim();
    if (!url) {
      log('Please enter the form POST URL.');
      return;
    }

    // Collect all entry name and answer pairs
    const entries = [];
    document.querySelectorAll('#fields-container .question').forEach(q => {
      const nameField = q.querySelector('input[type="text"]:nth-of-type(1)');
      const answerField = q.querySelector('input[type="text"]:nth-of-type(2)');
      const name = nameField.value.trim();
      const answer = answerField.value.trim();
      if (name && answer) {
        entries.push({ name, answer });
      }
    });

    if (entries.length === 0) {
      log('No fields to submit.');
      return;
    }

    // Prepare form data
    const formData = new URLSearchParams();
    entries.forEach(e => {
      formData.append(e.name, e.answer);
    });

    try {
      const response = await fetch(url, {
        method: 'POST',
        body: formData,
        headers: {
          'Content-Type': 'application/x-www-form-urlencoded'
        }
      });
      if (response.ok) {
        log('Response submitted successfully.');
      } else {
        log(`Failed to submit. Status: ${response.status}`);
      }
    } catch (err) {
      log(`Error: ${err.message}`);
    }
  });
</script>
</body>
</html>
